<!DOCTYPE html>
<html lang="zh-Hant">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>è–ç¶“å·²è®€çµ±è¨ˆï½œå¯å‹¾é¸ & è‡ªå‹•è¨˜éŒ„</title>
  <style>
    :root{
      --bg:#0f172a;
      --panel:#111827;
      --muted:#94a3b8;
      --text:#e5e7eb;
      --accent:#22c55e;
      --accent-2:#60a5fa;
      --border:#1f2937;
      --chip:#0b1220;
    }
    *{box-sizing:border-box}
    html,body{height:100%}
    body{
      margin:0;
      font-family: system-ui, -apple-system, "Segoe UI", Roboto, "Noto Sans TC", "Helvetica Neue", Arial, "Apple Color Emoji", "Segoe UI Emoji";
      background: radial-gradient(1200px 600px at 10% -10%, #1e293b 0, transparent 50%), 
                  radial-gradient(800px 400px at 120% -10%, #1f2937 0, transparent 50%), 
                  var(--bg);
      color:var(--text);
      line-height:1.5;
    }
    header{
      position:sticky; top:0; z-index:10;
      backdrop-filter:saturate(160%) blur(12px);
      background: linear-gradient(0deg, transparent, rgba(2,6,23,.8) 80%);
      padding: 16px 12px 12px;
      border-bottom:1px solid var(--border);
    }
    .container{max-width:1100px; margin:0 auto; padding: 0 14px 60px;}
    h1{margin:0; font-weight:800; letter-spacing:.3px; font-size:clamp(20px, 3.2vw, 30px)}
    .sub{color:var(--muted); margin-top:4px; font-size:14px}
    .toolbar{
      margin-top:12px; display:flex; gap:10px; flex-wrap:wrap; align-items:center
    }
    button, .chip, label.btn{
      border:1px solid var(--border); background:var(--chip); color:var(--text);
      padding:8px 12px; border-radius:10px; cursor:pointer; font-size:14px
    }
    button:hover, label.btn:hover{border-color:#2b3547}
    .chip{display:inline-flex; align-items:center; gap:8px; user-select:none}
    .chip b{font-weight:700}
    progress{
      width:240px; height:14px; vertical-align:middle; border-radius:8px; overflow:hidden;
      background:#0b1220; border:1px solid var(--border);
    }
    progress::-webkit-progress-bar{background:#0b1220}
    progress::-webkit-progress-value{background:linear-gradient(90deg, var(--accent), var(--accent-2))}
    progress::-moz-progress-bar{background:linear-gradient(90deg, var(--accent), var(--accent-2))}
    .books{
      margin-top:18px; display:grid; gap:12px;
      grid-template-columns: repeat(auto-fill, minmax(320px, 1fr));
    }
    details.book{
      border:1px solid var(--border); border-radius:14px; background:rgba(17,24,39,.55);
      box-shadow: 0 10px 30px rgba(2,6,23,.35) inset, 0 2px 10px rgba(0,0,0,.25);
    }
    details>summary{
      list-style:none; cursor:pointer; user-select:none;
      padding:14px 14px; border-bottom:1px solid var(--border); display:flex; gap:8px; align-items:center; justify-content:space-between
    }
    details[open]>summary{background:linear-gradient(0deg, rgba(255,255,255,.02), transparent)}
    summary .title{display:flex; gap:10px; align-items:baseline; flex-wrap:wrap}
    .title h3{margin:0; font-size:16px}
    .title .meta{color:var(--muted); font-size:12px}
    .summary-actions{display:flex; gap:8px; flex-wrap:wrap}
    .chapters{padding:12px 12px 16px}
    .grid{
      display:grid; grid-template-columns: repeat(10, 1fr); gap:6px;
    }
    .cell{
      display:flex; align-items:center; gap:6px; font-size:12px;
      padding:6px 8px; border:1px solid var(--border); border-radius:10px; background:rgba(2,6,23,.5);
    }
    .cell input[type="checkbox"]{width:16px; height:16px; cursor:pointer}
    .cell.read{background:linear-gradient(180deg, rgba(34,197,94,.15), rgba(2,6,23,.5)); border-color:#223f2f}
    .cell .stamp{color:var(--muted); font-size:10px; margin-left:auto}
    .filters{display:flex; gap:10px; flex-wrap:wrap; margin-top:10px}
    input[type="search"], input[type="file"]{
      background:var(--chip); color:var(--text); border:1px solid var(--border);
      padding:8px 12px; border-radius:10px; font-size:14px; outline:none;
    }
    .note{margin-top:8px; color:var(--muted); font-size:12px}
    .foot{margin-top:30px; color:var(--muted); font-size:12px; text-align:center}
    .hidden{display:none!important}
    @media (max-width: 480px){
      .grid{grid-template-columns: repeat(6, 1fr)}
      progress{width:100%}
    }
  </style>
</head>
<body>
  <header>
    <div class="container">
      <h1>ğŸ“– è–ç¶“å·²è®€çµ±è¨ˆï¼ˆå¯å‹¾é¸ãƒ»è‡ªå‹•è¨˜éŒ„ï¼‰</h1>
      <div class="sub">
        åƒè€ƒ <a href="https://cmtc.tw/daily-qt/bibletracker.html" target="_blank" rel="noopener" style="color:#93c5fd">CMTC è®€ç¶“è¿½è¹¤</a>ï¼Œæ­¤é æ”¯æ´å‹¾é¸ç« ç¯€ã€é€²åº¦çµ±è¨ˆã€åŒ¯å‡º/åŒ¯å…¥ï¼Œä»¥åŠæœ¬æ©Ÿè‡ªå‹•å„²å­˜ï¼ˆlocalStorageï¼‰ã€‚
      </div>
      <div class="toolbar">
        <span class="chip">å…¨æ›¸ç« æ•¸ï¼š<b id="totalChapters">â€”</b>ã€€å·²è®€ï¼š<b id="readCount">0</b>ã€€(<b id="percent">0</b>%)</span>
        <progress id="progress" value="0" max="1189" aria-label="ç¸½é€²åº¦"></progress>
        <button id="toggleUnread">åªé¡¯ç¤ºæœªè®€</button>
        <button id="expandAll">å±•é–‹å…¨éƒ¨</button>
        <button id="collapseAll">æ”¶åˆå…¨éƒ¨</button>
        <button id="resetAll">å…¨éƒ¨æ¸…é™¤</button>
        <button id="exportBtn">åŒ¯å‡ºé€²åº¦</button>
        <label class="btn">
          åŒ¯å…¥é€²åº¦
          <input id="importInput" type="file" accept="application/json" class="hidden" />
        </label>
      </div>
      <div class="filters">
        <input id="search" type="search" placeholder="æœå°‹æ›¸å·æˆ–ç« ç¯€ï¼Œä¾‹å¦‚ï¼šå‰µã€å‰µä¸–è¨˜ 1ã€John 3" />
        <span class="note">è³‡æ–™åƒ…å„²å­˜åœ¨æ‚¨çš„è£ç½®ï¼ˆä¸æœƒä¸Šå‚³ï¼‰ã€‚</span>
      </div>
    </div>
  </header>

  <main class="container">
    <section id="books" class="books"></section>
    <div class="foot">v1.0 Â· è£½ä½œï¼šæ‚¨çš„æ•™æœƒï¼å°çµ„ Â· å¯é›¢ç·šä½¿ç”¨</div>
  </main>

<script>
const bibleData = [
  ["å‰µä¸–è¨˜",50],["å‡ºåŸƒåŠè¨˜",40],["åˆ©æœªè¨˜",27],["æ°‘æ•¸è¨˜",36],["ç”³å‘½è¨˜",34],
  ["ç´„æ›¸äºè¨˜",24],["å£«å¸«è¨˜",21],["è·¯å¾—è¨˜",4],["æ’’æ¯è€³è¨˜ä¸Š",31],["æ’’æ¯è€³è¨˜ä¸‹",24],
  ["åˆ—ç‹ç´€ä¸Š",22],["åˆ—ç‹ç´€ä¸‹",25],["æ­·ä»£å¿—ä¸Š",29],["æ­·ä»£å¿—ä¸‹",36],["ä»¥æ–¯æ‹‰è¨˜",10],
  ["å°¼å¸Œç±³è¨˜",13],["ä»¥æ–¯å¸–è¨˜",10],["ç´„ä¼¯è¨˜",42],["è©©ç¯‡",150],["ç®´è¨€",31],
  ["å‚³é“æ›¸",12],["é›…æ­Œ",8],["ä»¥è³½äºæ›¸",66],["è€¶åˆ©ç±³æ›¸",52],["è€¶åˆ©ç±³å“€æ­Œ",5],
  ["ä»¥è¥¿çµæ›¸",48],["ä½†ä»¥ç†æ›¸",12],["ä½•è¥¿é˜¿æ›¸",14],["ç´„ç¥æ›¸",3],["é˜¿æ‘©å¸æ›¸",9],
  ["ä¿„å·´åº•äºæ›¸",1],["ç´„æ‹¿æ›¸",4],["å½Œè¿¦æ›¸",7],["é‚£é´»æ›¸",3],["å“ˆå·´è°·æ›¸",3],
  ["è¥¿ç•ªé›…æ›¸",3],["å“ˆè©²æ›¸",2],["æ’’è¿¦åˆ©äºæ›¸",14],["ç‘ªæ‹‰åŸºæ›¸",4],
  ["é¦¬å¤ªç¦éŸ³",28],["é¦¬å¯ç¦éŸ³",16],["è·¯åŠ ç¦éŸ³",24],["ç´„ç¿°ç¦éŸ³",21],["ä½¿å¾’è¡Œå‚³",28],
  ["ç¾…é¦¬æ›¸",16],["å“¥æ—å¤šå‰æ›¸",16],["å“¥æ—å¤šå¾Œæ›¸",13],["åŠ æ‹‰å¤ªæ›¸",6],["ä»¥å¼—æ‰€æ›¸",6],
  ["è…“ç«‹æ¯”æ›¸",4],["æ­Œç¾…è¥¿æ›¸",4],["å¸–æ’’ç¾…å°¼è¿¦å‰æ›¸",5],["å¸–æ’’ç¾…å°¼è¿¦å¾Œæ›¸",3],
  ["ææ‘©å¤ªå‰æ›¸",6],["ææ‘©å¤ªå¾Œæ›¸",4],["æå¤šæ›¸",3],["è…“åˆ©é–€æ›¸",1],["å¸Œä¼¯ä¾†æ›¸",13],
  ["é›…å„æ›¸",5],["å½¼å¾—å‰æ›¸",5],["å½¼å¾—å¾Œæ›¸",3],["ç´„ç¿°ä¸€æ›¸",5],["ç´„ç¿°äºŒæ›¸",1],
  ["ç´„ç¿°ä¸‰æ›¸",1],["çŒ¶å¤§æ›¸",1],["å•Ÿç¤ºéŒ„",22]
];
const totalChapters = bibleData.reduce((sum,b)=>sum+b[1],0);
document.getElementById("totalChapters").textContent = totalChapters;

const booksContainer = document.getElementById("books");
const readData = JSON.parse(localStorage.getItem("bibleProgress")||"{}");

function saveData(){
  localStorage.setItem("bibleProgress", JSON.stringify(readData));
  updateProgress();
}

function updateProgress(){
  let readCount=0;
  Object.values(readData).forEach(book=>{
    Object.values(book).forEach(val=>{
      if(val) readCount++;
    });
  });
  document.getElementById("readCount").textContent = readCount;
  document.getElementById("percent").textContent = ((readCount/totalChapters)*100).toFixed(1);
  document.getElementById("progress").value = readCount;
}

function createBook(name,chapters){
  const details=document.createElement("details");
  details.className="book";
  const summary=document.createElement("summary");
  const titleDiv=document.createElement("div");
  titleDiv.className="title";
  const h3=document.createElement("h3");
  h3.textContent=name;
  const meta=document.createElement("span");
  meta.className="meta";
  meta.textContent=`å…± ${chapters} ç« `;
  titleDiv.appendChild(h3);
  titleDiv.appendChild(meta);

  const actions=document.createElement("div");
  actions.className="summary-actions";
  const btnAll=document.createElement("button");
  btnAll.textContent="å…¨é¸";
  btnAll.onclick=(e)=>{e.stopPropagation();for(let i=1;i<=chapters;i++){setRead(name,i,true);}saveData();render();};
  const btnClear=document.createElement("button");
  btnClear.textContent="æ¸…é™¤";
  btnClear.onclick=(e)=>{e.stopPropagation();for(let i=1;i<=chapters;i++){setRead(name,i,false);}saveData();render();};
  actions.appendChild(btnAll);
  actions.appendChild(btnClear);

  summary.appendChild(titleDiv);
  summary.appendChild(actions);
  details.appendChild(summary);

  const chapWrap=document.createElement("div");
  chapWrap.className="chapters";
  const grid=document.createElement("div");
  grid.className="grid";
  for(let i=1;i<=chapters;i++){
    const cell=document.createElement("label");
    cell.className="cell";
    const cb=document.createElement("input");
    cb.type="checkbox";
    cb.checked = readData[name] && readData[name][i];
    cb.onchange=()=>{
      setRead(name,i,cb.checked);
      saveData();
      render();
    };
    const span=document.createElement("span");
    span.textContent=i;
    cell.appendChild(cb);
    cell.appendChild(span);
    const stamp=document.createElement("span");
    stamp.className="stamp";
    if(readData[name] && readData[name][i] && typeof readData[name][i]==="string"){
      stamp.textContent=readData[name][i];
    }
    cell.appendChild(stamp);
    if(cb.checked) cell.classList.add("read");
    grid.appendChild(cell);
  }
  chapWrap.appendChild(grid);
  details.appendChild(chapWrap);
  booksContainer.appendChild(details);
}

function setRead(book,chapter,val){
  if(!readData[book]) readData[book]={};
  if(val){
    const date=new Date();
    readData[book][chapter]=`${date.getFullYear()}/${(date.getMonth()+1).toString().padStart(2,"0")}/${date.getDate().toString().padStart(2,"0")}`;
  }else{
    delete readData[book][chapter];
  }
}

function render(){
  booksContainer.innerHTML="";
  bibleData.forEach(([name,ch])=>{
    createBook(name,ch);
  });
  updateProgress();
}

render();

// åŠŸèƒ½æŒ‰éˆ•
document.getElementById("toggleUnread").onclick=()=>{
  document.querySelectorAll(".book").forEach(book=>{
    if(book.open===false) book.open=true;
    book.querySelectorAll(".cell").forEach(cell=>{
      const cb=cell.querySelector("input");
      cell.classList.remove("hidden");
      if(document.getElementById("toggleUnread").dataset.mode!=="unread") return;
      if(cb.checked) cell.classList.add("hidden");
    });
  });
  if(document.getElementById("toggleUnread").dataset.mode==="unread"){
    document.getElementById("toggleUnread").dataset.mode="";
    document.getElementById("toggleUnread").textContent="åªé¡¯ç¤ºæœªè®€";
  }else{
    document.getElementById("toggleUnread").dataset.mode="unread";
    document.getElementById("toggleUnread").textContent="é¡¯ç¤ºå…¨éƒ¨";
  }
};

document.getElementById("expandAll").onclick=()=>{
  document.querySelectorAll(".book").forEach(b=>b.open=true);
};
document.getElementById("collapseAll").onclick=()=>{
  document.querySelectorAll(".book").forEach(b=>b.open=false);
};

document.getElementById("resetAll").onclick=()=>{
  if(confirm("ç¢ºå®šè¦æ¸…é™¤å…¨éƒ¨ç´€éŒ„å—ï¼Ÿ")){
    localStorage.removeItem("bibleProgress");
    Object.keys(readData).forEach(k=>delete readData[k]);
    render();
  }
};

document.getElementById("exportBtn").onclick=()=>{
  const blob=new Blob([JSON.stringify(readData)],{type:"application/json"});
  const url=URL.createObjectURL(blob);
  const a=document.createElement("a");
  a.href=url;
  a.download="bible-progress.json";
  a.click();
  URL.revokeObjectURL(url);
};

document.getElementById("importInput").onchange=(e)=>{
  const file=e.target.files[0];
  if(!file) return;
  const reader=new FileReader();
  reader.onload=()=>{
    try{
      const data=JSON.parse(reader.result);
      Object.keys(data).forEach(b=>{
        readData[b]=data[b];
      });
      saveData();
      render();
    }catch(err){alert("åŒ¯å…¥å¤±æ•—ï¼šæª”æ¡ˆæ ¼å¼éŒ¯èª¤");}
  };
  reader.readAsText(file);
};

// æœå°‹åŠŸèƒ½
document.getElementById("search").oninput=(e)=>{
  const val=e.target.value.trim().toLowerCase();
  document.querySelectorAll(".book").forEach(book=>{
    const name=book.querySelector("h3").textContent.toLowerCase();
    let match=false;
    if(!val){match=true;}
    else if(name.includes(val)) match=true;
    else{
      const matchChap = val.match(/^(.+?)\s*(\d+)$/);
      if(matchChap){
        const bookName = matchChap[1];
        const chapNum = parseInt(matchChap[2]);
        if(name.includes(bookName.toLowerCase())){
          book.open=true;
          book.querySelectorAll(".cell").forEach(cell=>{
            const spanNum=cell.querySelector("span").textContent;
            if(parseInt(spanNum)===chapNum) cell.scrollIntoView({behavior:"smooth",block:"center"});
          });
          match=true;
        }
      }
    }
    book.style.display=match?"":"none";
  });
};
</script>

</body>
</html>






